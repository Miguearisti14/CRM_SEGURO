{% extends 'layout_panel.html' %}
{% load static %}

{% block title %}M茅tricas - ZuluAris CRM{% endblock %}

{% block content %}
<link rel="stylesheet" href="{% static 'css/reportes_metricas.css' %}">

<section class="metricas-container">
    <h2 class="titulo-seccion">Reporte de M茅tricas</h2>
    <p class="descripcion-seccion">Visualiza tus indicadores clave y el rendimiento de tus clientes y p贸lizas.</p>

    <!--  M茅tricas generales -->
    <div class="metricas-grid">
        <div class="metrica-card">
            <h4>Clientes</h4>
            <p class="metrica-valor">{{ total_clientes }}</p>
        </div>
        <div class="metrica-card">
            <h4>P贸lizas</h4>
            <p class="metrica-valor">{{ total_polizas }}</p>
        </div>
        <div class="metrica-card">
            <h4>Interacciones</h4>
            <p class="metrica-valor">{{ total_interacciones }}</p>
        </div>
        <div class="metrica-card">
            <h4>Reclamaciones</h4>
            <p class="metrica-valor">{{ total_reclamaciones }}</p>
        </div>
    </div>

    <!--  Gr谩ficos -->
    <div class="graficos-grid">
        <div class="grafico-card">
            <h4>Reclamaciones por estado</h4>
            <canvas id="graficoReclamaciones" width="400" height="300"></canvas>
        </div>
        <div class="grafico-card grafico-canales">
            <h4>Canales de venta</h4>
            <canvas id="graficoCanales" width="600" height="300"></canvas>
        </div>
        <div class="grafico-card">
            <h4>Interacciones por tipo</h4>
            <canvas id="graficoInteracciones" width="400" height="300"></canvas>
        </div>
    </div>

    <!-- fila 2: nuevos gr谩ficos -->
    <div class="graficos-grid">
        <div class="grafico-card grafico-tipo">
            <h4>P贸lizas por producto</h4>
            <canvas id="graficoPolizasTipo" width=auto height="350"></canvas>
        </div>

        <div class="grafico-card">
            <h4>P贸lizas pr贸ximas a vencer (30 d铆as)</h4>
            <canvas id="graficoProximasVencer" width="500" height="350"></canvas>
        </div>

        <div class="grafico-card">
            <h4>P贸lizas nuevas por mes</h4>
            <canvas id="graficoPolizasNuevas" width=auto height="350"></canvas>
        </div>

    </div>

    <div class="graficos-grid">
        
        
    </div>
</section>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    const dataReclamaciones = {{ reclamaciones_por_estado|safe }};
    const dataCanales = {{ canales_venta|safe }};
    const dataInteracciones = {{ interacciones_tipo|safe }};

    const dataPolizasTipo = {{ polizas_por_producto|safe }};
    const dataPolizasProximas = {{ polizas_proximas|safe }};
    const dataPolizasNuevas = {{ polizas_nuevas_mes|safe }};
</script>
<script src="{% static 'js/metricas.js' %}"></script>
{% endblock %}
